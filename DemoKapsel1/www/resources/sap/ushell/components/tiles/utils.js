// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
this.sap=this.sap||{};(function(){"use strict";jQuery.sap.declare("sap.ushell.components.tiles.utils");sap=sap||{};sap.ushell=sap.ushell||{};sap.ushell.components=sap.ushell.components||{};sap.ushell.components.tiles=sap.ushell.components.tiles||{};sap.ushell.components.tiles.utils=sap.ushell.components.tiles.utils||{};if(sap.ushell.components.tiles.utils.getConfiguration){return;}var t;function s(q){var n=q.replace(/\+/g,' ').split("&"),p,i,r=[];for(i=0;i<n.length;i+=1){p=n[i].split("=");r.push({name:decodeURIComponent(p.shift()),value:decodeURIComponent(p.join("="))});}return r;}sap.ushell.components.tiles.utils.isInitial=function(T){return T==="App Launcher – Static"||T==="App Launcher – Dynamic"||T==="Target Mapping";};sap.ushell.components.tiles.utils.getResourceBundleModel=function(){jQuery.sap.require("sap.ushell.resources");return sap.ushell.resources.i18nModel;};sap.ushell.components.tiles.utils.getConfiguration=function(T,a,E){var r,C=T.configuration.getParameterValueAsString('tileConfiguration'),o=JSON.parse(C||"{}"),b=sap.ushell.components.tiles.utils.getTranslatedTitle(T),S=sap.ushell.components.tiles.utils.getTranslatedSubtitle(T,o),i=sap.ushell.components.tiles.utils.getTranslatedProperty(T,o,'display_info_text'),k=sap.ushell.components.tiles.utils.getTranslatedProperty(T,o,'display_search_keywords');if(a){r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();if(E&&T.bag){var f=T.bag.getOriginalLanguage();var u=sap.ui.getCore().getConfiguration().getLanguage();o.isLocaleSuitable=f===""||f.toLowerCase()===u.toLowerCase();o.orgLocale=f;o.userLocale=u;}}o.display_icon_url=o.display_icon_url||"";if(i!==undefined){o.display_info_text=i;}else if(o.display_info_text===undefined){if(a&&!E){o.display_info_text="["+r.getText("configuration.display_info_text")+"]";}else{o.display_info_text="";}}o.navigation_semantic_object=o.navigation_semantic_object||"";o.navigation_semantic_action=o.navigation_semantic_action||"";o.navigation_semantic_parameters=o.navigation_semantic_parameters||"";o.display_number_unit=o.display_number_unit||"";o.display_number_factor=o.display_number_factor||"";o.service_refresh_interval=o.service_refresh_interval||0;o.service_url=o.service_url||"";o.navigation_target_url=o.navigation_target_url||"";if(a&&sap.ushell.components.tiles.utils.isInitial(b)){o.display_title_text=E?"":"["+r.getText("configuration.display_title_text")+"]";o.display_subtitle_text=E?"":"["+r.getText("configuration.display_subtitle_text")+"]";}else{o.display_title_text=b||o.display_title_text||"";if(S!==undefined){o.display_subtitle_text=S;}else if(o.display_subtitle_text===undefined){o.display_subtitle_text="";}}o.navigation_use_semantic_object=(o.navigation_use_semantic_object===false?false:true);o.display_search_keywords=k||o.display_search_keywords||"";if(a){o.display_number_value=o.display_number_value||1234;}o.form_factors=o.form_factors?o.form_factors:this.getDefaultFormFactors();o.desktopChecked=o.form_factors.manual.desktop;o.tabletChecked=o.form_factors.manual.tablet;o.phoneChecked=o.form_factors.manual.phone;o.manualFormFactor=!(o.form_factors.appDefault);o.appFormFactor=o.form_factors.appDefault;o.formFactorConfigDefault=o.form_factors.defaultParam?true:false;o.rows=(o.mapping_signature&&o.mapping_signature!=="*=*")?this.getMappingSignatureTableData(o.mapping_signature):[this.getEmptyRowObj()];o.isUnknownAllowed=(o.mapping_signature!==undefined)?this.getAllowUnknownParametersValue(o.mapping_signature):true;if(a){o.tile_actions_rows=this.getTileNavigationActionsRows(T);}else{if(!o.actions){o.actions=this.getTileNavigationActions(T);}}return o;};sap.ushell.components.tiles.utils.getEmptyRowObj=function(){return{name:"",mandatory:false,value:"",isRegularExpression:false,defaultValue:"",valEnabled:false,defValEnabled:true};};sap.ushell.components.tiles.utils.getEmptyTileActionsRowObj=function(){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();return{menu_title:"",target_type:r.getText("configuration.tile_actions.table.target_type.url"),navigation_target:"",action:"",icon:"",isTargetTypeIntent:false};};sap.ushell.components.tiles.utils.getTileNavigationActionsRows=function(T){var a=[],b=[];b=this.getTileNavigationActions(T);if(b.length){for(var i=0;i<b.length;i++){a.push(c(b[i]));}}else{a=[this.getEmptyTileActionsRowObj()];}return a;};sap.ushell.components.tiles.utils.getTileNavigationActions=function(T){var a=[],b='';var f=T.bag.getBag('tileNavigationActions');if(f.getPropertyNames().indexOf('tile_navigation_actions')>=0){a=JSON.parse(f.getProperty('tile_navigation_actions'));for(var i=0;i<a.length;i++){if(a[i].text){if(f.getTextNames().indexOf('action_tile_'+(i+1))>=0){b=f.getText('action_tile_'+(i+1));}a[i].text=b;}}}return a;};var c=function(T){var a={},r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();a.menu_title=T.text;a.icon=T.icon;if((T.targetURL).charAt(0)==="#"){a.target_type=r.getText("configuration.tile_actions.table.target_type.intent");var n=T.targetURL.split("-");a.navigation_target=n[0].substring(1,n[0].length);a.action=n[1];a.isTargetTypeIntent=true;}else{a.target_type=r.getText("configuration.tile_actions.table.target_type.url");a.navigation_target=T.targetURL;a.action="";a.isTargetTypeIntent=false;}return a;};sap.ushell.components.tiles.utils.tileActionsRows2TileActionsArray=function(T){var a=[];for(var i=0;i<T.length;i++){if(T[i].menu_title){a.push(d(T[i]));}}return a;};var d=function(T){var o={};o.text=T.menu_title;o.icon=T.icon;if(T.action){o.targetURL="#"+T.navigation_target+"-"+T.action;}else{o.targetURL=T.navigation_target;}return o;};sap.ushell.components.tiles.utils.populateTileNavigationActionsBag=function(a,n){a.setProperty('tile_navigation_actions',JSON.stringify(n));for(var i=0;i<n.length;i++){var A=n[i].text;a.setText('action_tile_'+(i+1),A);}};sap.ushell.components.tiles.utils.getDefaultFormFactors=function(){return{"appDefault":false,"manual":{"desktop":true,"tablet":true,"phone":true},"defaultParam":true};};sap.ushell.components.tiles.utils.buildFormFactorsObject=function(m){return{"appDefault":m.getProperty("/config/appFormFactor"),"manual":{"desktop":m.getProperty("/config/desktopChecked"),"tablet":m.getProperty("/config/tabletChecked"),"phone":m.getProperty("/config/phoneChecked")}};};sap.ushell.components.tiles.utils.tableHasDuplicateParameterNames=function(T){var p={};for(var i=0;i<T.length;i++){var a=T[i].name;if(a!==""){if(p[a]){return true;}else{p[a]=true;}}}return false;};sap.ushell.components.tiles.utils.getMappingSignatureString=function(a,b){var m="";for(var i=0;i<a.length;i++){if(a[i].name){m+=(g(a[i])+"&");}}return b?m+"*=*":m.substring(0,m.length-1);};var g=function(a){var p="";if(a.mandatory){if(a.isRegularExpression){p="{"+a.name+"="+encodeURIComponent(a.value)+"}";}else{p=a.name+"="+encodeURIComponent(a.value);}}else{p="["+a.name+"="+encodeURIComponent(a.defaultValue)+"]";}return p;};sap.ushell.components.tiles.utils.getMappingSignatureTableData=function(m){var p=[];var a=m.split("&");for(var i=0;i<a.length;i++){var b=a[i];if(b!=="*=*"){p.push(e(a[i]));}}return p;};var e=function(p){var a={};if(p.charAt(0)==="["){a.mandatory=false;a.isRegularExpression=false;a.value="";p=p.substring(1,p.length-1);a.name=p.substring(0,p.indexOf("="));a.defaultValue=decodeURIComponent(p.substring(p.indexOf("=")+1));}else{a.mandatory=true;a.defaultValue="";if(p.charAt(0)==="{"){a.isRegularExpression=true;p=p.substring(1,p.length-1);}else{a.isRegularExpression=false;}a.name=p.substring(0,p.indexOf("="));a.value=decodeURIComponent(p.substring(p.indexOf("=")+1));}a.valEnabled=a.mandatory;a.defValEnabled=!a.mandatory;return a;};sap.ushell.components.tiles.utils.getAllowUnknownParametersValue=function(m){if(m&&(m.substring(m.length-3,m.length)==="*=*")){return true;}else{return false;}};sap.ushell.components.tiles.utils.getTranslatedTitle=function(T){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf("display_title_text")>=0){return b.getText('display_title_text');}}if(T.title){return T.title.getTitle();}if(T.preview){return T.preview.getTitle();}return"";};sap.ushell.components.tiles.utils.getTranslatedSubtitle=function(T,C){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf("display_subtitle_text")>=0){return b.getText('display_subtitle_text');}}if(T.preview&&T.preview.getDescription&&T.preview.getDescription()){return T.preview.getDescription();}return C['display_subtitle_text'];};sap.ushell.components.tiles.utils.getTranslatedProperty=function(T,o,p){if(T.bag){var b=T.bag.getBag('tileProperties');if(b.getTextNames().indexOf(p)>=0){return b.getText(p);}}return o[p];};sap.ushell.components.tiles.utils.getActionConfiguration=function(C,a){var o=JSON.parse(C||"{}"),r;if(a){r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();}o.semantic_object=o.semantic_object||(a?"["+r.getText("configuration.semantic_object")+"]":"");o.semantic_action=o.semantic_action||(a?"["+r.getText("configuration.semantic_action")+"]":"");o.navigation_provider=o.navigation_provider||"";o.navigation_provider_role=o.navigation_provider_role||"";o.navigation_provider_instance=o.navigation_provider_instance||"";o.target_application_id=o.target_application_id||"";o.target_application_alias=o.target_application_alias||"";o.display_info_text=o.display_info_text||"";return o;};sap.ushell.components.tiles.utils.getConfigurationUi=function(v,V){var o=v.getViewData(),T=o.chip,C,S,a;var b=sap.ushell.components.tiles.utils.getConfiguration(T,true,true);var f=new sap.ui.model.json.JSONModel({config:b,tileModel:v.getModel()});C=new sap.ui.view({type:sap.ui.core.mvc.ViewType.XML,viewData:o,viewName:V});C.setModel(f);S=C.byId("navigation_semantic_objectInput")||C.byId("semantic_objectInput");if(S){S.getModel().setProperty("/enabled",b.navigation_use_semantic_object);S.getModel().setProperty("/value",b.semantic_object||b.navigation_semantic_object);}a=C.byId("typeLpd_cust");if(a){if(v.getModel().getProperty('/config/navigation_provider')=="LPD"||v.getModel().getProperty('/config/navigation_provider')==''){C.byId("typeLpd_cust").setSelected(true);C.byId("typeSapui5").setSelected(false);sap.ushell.components.tiles.utils.displayLpdCustApplicationTypeFields(C);}else if(v.getModel().getProperty('/config/navigation_provider')=="SAPUI5"){C.byId("typeLpd_cust").setSelected(false);C.byId("typeSapui5").setSelected(true);sap.ushell.components.tiles.utils.displaySapui5ApplicationTypeFields(C);}}return C;};sap.ushell.components.tiles.utils.getDataToDisplay=function(C,D){var a=0,i,n,o,b,f={display_icon_url:D.icon||C.display_icon_url||"",display_title_text:D.title||C.display_title_text||"",display_number_value:!isNaN(D.number)?D.number:"...",display_number_unit:D.numberUnit||C.display_number_unit||"",display_info_text:D.info||C.display_info_text||"",display_info_state:D.infoState||"Neutral",display_subtitle_text:D.subtitle||C.display_subtitle_text||"",display_state_arrow:D.stateArrow||"None",display_number_state:D.numberState||"Neutral",display_number_digits:D.numberDigits||0,display_number_factor:D.numberFactor||"",display_search_keyword:D.keywords||C.display_search_keyword||"",targetParams:[]};if(D.infoStatus){f.display_info_state=D.infoStatus;}if(D.targetParams){f.targetParams.push(D.targetParams);}if(D.results){for(i=0,n=D.results.length;i<n;i=i+1){o=D.results[i].number||0;if(typeof o==="string"){o=parseInt(o,10);}a=a+o;b=D.results[i].targetParams;if(b){f.targetParams.push(b);}}f.display_number_value=a;}return f;};sap.ushell.components.tiles.utils.getSemanticNavigationUrl=function(C){var u="#"+jQuery.trim(C.navigation_semantic_object);u+="-"+jQuery.trim(C.navigation_semantic_action);if(C.navigation_semantic_parameters&&jQuery.trim(C.navigation_semantic_parameters).length>0){u+="?"+jQuery.trim(C.navigation_semantic_parameters);}return u;};sap.ushell.components.tiles.utils.addParamsToUrl=function(u,D){var p="",U=u.indexOf("?")!==-1,T=D.targetParams,i;if(T&&T.length>0){for(i=0;i<T.length;i=i+1){p+=T[i];if(i<T.length-1){p+="&";}}}if(p.length>0){if(!U){u+="?";}else{u+="&";}u+=p;}return u;};sap.ushell.components.tiles.utils.aData=[];sap.ushell.components.tiles.utils.objectSelectDoSearch=function(E){var f=[],v=E.getParameter("value"),i,a,b;if(v!==undefined){i=E.getParameter("itemsBinding");a=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);b=new sap.ui.model.Filter("obj",sap.ui.model.FilterOperator.Contains,v);f.push(b);f.push(a);i.filter(new sap.ui.model.Filter(f,false));}};sap.ushell.components.tiles.utils.objectSelectUpdateDialog=function(S,v){var f=[],i=S.getBinding("items"),a;if(v!==undefined){a=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);f.push(a);i.filter(f);}};sap.ushell.components.tiles.utils.sSelectedColor=(jQuery(".sapMStdTileIconDiv").css('color')||"#007cc0").split(" ").join("");sap.ushell.components.tiles.utils.sDeselectedColor=(jQuery(".sapMLabel:not(.sapFioriDropZoneText )").css('color')||"#666666").split(" ").join("");sap.ushell.components.tiles.utils.iconSelect=function(i,S){i.setColor(S?sap.ushell.components.tiles.utils.sSelectedColor:sap.ushell.components.tiles.utils.sDeselectedColor);i.setActiveColor(S?sap.ushell.components.tiles.utils.sDeselectedColor:sap.ushell.components.tiles.utils.sSelectedColor);};sap.ushell.components.tiles.utils.onSelectIcon=function(C,i,T,o){var m=C.getView().getModel(),S;if(i){S=m.getProperty("/config/tile_actions_selected_icon");}else{S=m.getProperty("/config/selected_icon");}if(S){sap.ushell.components.tiles.utils.iconSelect(S,false);}S=o.getSource();sap.ushell.components.tiles.utils.iconSelect(S,true);m.setProperty("/config/ok.enabled",true);if(i){m.setProperty("/config/tile_actions_selected_icon",S);T.setValue(S.getSrc());}else{m.setProperty("/config/selected_icon",S);}C.byId("selectIconDialog").setTitle(S.getSrc());};sap.ushell.components.tiles.utils.onSelectIconClose=function(v){v.byId("selectIconDialog").close();};sap.ushell.components.tiles.utils.onSelectIconOk=function(v){var S=v.getModel().getProperty("/config/selected_icon");if(S){v.getModel().setProperty("/config/display_icon_url",S.getSrc());}sap.ushell.components.tiles.utils.onSelectIconClose(v);};sap.ushell.components.tiles.utils.iconSelectOnValueHelpRequest=function(C,E,a){var m=C.getView().getModel(),r=C.getView().byId("icons"),b=sap.ui.core.IconPool.getIconCollectionNames(),f,D=C.getView().byId("selectIconDialog"),I,T,h,i,j,u,B=false;r.destroyContent();if(a){T=sap.ui.getCore().byId(E.getParameter('id'));I=T.getValue();}else{I=m.getProperty("/config/display_icon_url");}b.sort();b=jQuery.grep(b,function(v){if(v==="BusinessSuiteInAppSymbols"){B=true;return false;}return true;});if(B){b.push("BusinessSuiteInAppSymbols");}for(i=0;i<b.length;i+=1){h=sap.ui.core.IconPool.getIconNames(b[i]);h.sort();for(j=0;j<h.length;j+=1){u=sap.ui.core.IconPool.getIconURI(h[j],b[i]);r.addContent(new sap.ui.core.Icon({height:"38px",press:sap.ushell.components.tiles.utils.onSelectIcon.bind(null,C,a,T),size:"2rem",src:u,tooltip:u,width:"38px"}));}}f=r.getContent();m.setProperty("/config/ok.enabled",false);D.bindProperty("title",{model:"i18n",path:"configuration.select_icon"});for(i=0;i<f.length;i+=1){if(f[i].getSrc()===I){if(a){m.setProperty("/config/tile_actions_selected_icon",f[i]);}else{m.setProperty("/config/selected_icon",f[i]);}sap.ushell.components.tiles.utils.iconSelect(f[i],true);m.setProperty("/config/ok.enabled",true);D.setTitle(I);}else{sap.ushell.components.tiles.utils.iconSelect(f[i],false);}}D.open();};sap.ushell.components.tiles.utils.objectSelectOnValueHelpRequest=function(C,E,i){var v=C.getView(),T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle().getText("configuration.semantic_object"),S,V,o=new sap.ui.model.json.JSONModel(),a=new sap.m.SelectDialog("semantic_object_select_dialog",{title:T,search:sap.ushell.components.tiles.utils.objectSelectDoSearch,liveChange:sap.ushell.components.tiles.utils.objectSelectDoSearch}),b=new sap.m.StandardListItem({title:"{obj}"});if(i){S=sap.ui.getCore().byId(E.getParameter('id'));}else{S=v.byId("semantic_objectInput")||v.byId("navigation_semantic_objectInput");}V=S.getValue();a.open(V);o.setData(C.aDefaultObjects.concat(sap.ushell.components.tiles.utils.aData));a.bindAggregation("items","/",b);a.setModel(o);sap.ushell.components.tiles.utils.objectSelectUpdateDialog(a,V);a.attachCancel(function(f){S.setValue(V);if(!i){S.fireChange();}a.destroy();a=null;});a.attachConfirm(function(f){var h=f.getParameter("selectedItem");if(h){S.setValue(h.getTitle());if(!i){S.fireChange();}}a.destroy();a=null;});};sap.ushell.components.tiles.utils.onTargetTypeChange=function(T){var i=T.getParameter('id');var p=sap.ui.getCore().byId(i).getParent().getCells();var a=T.getParameter('newValue');if(a=="Intent"){p[3].setEnabled(true);p[2].setShowValueHelp(true);p[2].setValue("");}else{p[2].setShowValueHelp(false);p[2].setValue("");p[3].setEnabled(false);p[3].setValue("");}};sap.ushell.components.tiles.utils.addTileActionsRow=function(C){var m=C.getModel();var r=m.getProperty('/config/tile_actions_rows');var n=this.getEmptyTileActionsRowObj();r.push(n);m.setProperty('/config/tile_actions_rows',r);};sap.ushell.components.tiles.utils.deleteTileActionsRow=function(C){var m=C.getModel();var r=m.getProperty('/config/tile_actions_rows');var f=C.byId("tileActions");var S=f.getSelectedIndices();var h=S.sort(function(a,b){return b-a;}).slice();for(var i=0;i<h.length;i++){f.removeSelectionInterval(h[i],h[i]);r.splice(h[i],1);}m.setProperty('/config/tile_actions_rows',r);};sap.ushell.components.tiles.utils.checkInput=function(C,o){var T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle(),i=C.byId("iconInput"),u=C.byId("useLpdCheckbox"),S=C.byId("navigation_semantic_objectInput")||C.byId("semantic_objectInput"),a=C.byId("navigation_semantic_actionInput")||C.byId("semantic_actionInput"),n=jQuery.trim(o.getParameter("newValue")),I,f,v=sap.ui.core.ValueState.None,V=null,j;switch(o.getSource()){case i:if(n!=""&&n.substring(0,11)!=="sap-icon://"){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.display_icon_url.warning");}break;case u:if(!u.getSelected()){a.setValueState(sap.ui.core.ValueState.None);S.setValueState(sap.ui.core.ValueState.None);}break;case S:I=S.getModel().getProperty("/items");f=false;for(j=0;j<I.length;j=j+1){if(I[j].obj===n){f=true;break;}}if(/[\-#&? ]/.test(n)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_object.error_invalid_chars");}else if(!f){v=sap.ui.core.ValueState.Warning;V=T.getText("configuration.semantic_object.warning");}else if(n==""){v=sap.ui.core.ValueState.Error;}break;case a:if(/[\-#&? ]/.test(n)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_action.error_invalid_chars");}else if(n==""){v=sap.ui.core.ValueState.Error;}break;default:break;}if(v){o.getSource().setValueState(v);if(V!==null){o.getSource().setValueStateText(V||"");}}};sap.ushell.components.tiles.utils.checkInputOnSaveConfig=function(C){var i=C.byId("iconInput"),S=C.byId("navigation_semantic_objectInput"),o=C.byId("navigation_semantic_actionInput"),u=C.byId("useLpdCheckbox"),T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle(),I=S.getModel().getProperty("/items"),f=false,r=false,j;if(i.getValue()!=""&&i.getValue().substring(0,11)!=="sap-icon://"){i.setValueState(sap.ui.core.ValueState.Error);i.setValueStateText(T.getText("configuration.display_icon_url.warning"));r=true;}for(j=0;j<I.length;j=j+1){if(I[j].obj===S.getValue()){f=true;break;}}if(u.getSelected()&&/[\-#&? ]/.test(S.getValue())){S.setValueState(sap.ui.core.ValueState.Error);S.setValueStateText(T.getText("configuration.semantic_object.error_invalid_chars"));r=true;}else if(u.getSelected()&&!f){S.setValueState(sap.ui.core.ValueState.Warning);S.setValueStateText(T.getText("configuration.semantic_object.warning"));}else if(u.getSelected()&&S.getValue()==""){S.setValueState(sap.ui.core.ValueState.Error);r=true;}if(/[\-#&? ]/.test(o.getValue())){o.setValueState(sap.ui.core.ValueState.Error);o.setValueStateText(T.getText("configuration.semantic_action.error_invalid_chars"));r=true;}else if(u.getSelected()&&o.getValue()==""){o.setValueState(sap.ui.core.ValueState.Error);r=true;}return r;};sap.ushell.components.tiles.utils.checkTMInput=function(C,o){var T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle(),S=C.byId("semantic_objectInput"),a=C.byId("semantic_actionInput"),b=C.byId("target_application_descriptionInput"),f=C.byId("target_application_urlInput"),h=C.byId("target_application_componentInput"),n=C.byId("navigation_provider_roleInput"),N=C.byId("navigation_provider_instanceInput"),i=C.byId("target_application_aliasInput"),k=C.byId("target_application_idInput"),l=C.byId("typeLpd_cust"),m=C.byId("typeSapui5"),p=jQuery.trim(o.getParameter("newValue")),I,F,v=sap.ui.core.ValueState.None,V=null,j;switch(o.getSource()){case S:I=S.getModel().getProperty("/items");F=false;for(j=0;j<I.length;j=j+1){if(I[j].obj===p){F=true;break;}}if(/[\-#&? ]/.test(p)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_object.error_invalid_chars");}else if(!F){v=sap.ui.core.ValueState.Warning;V=T.getText("configuration.semantic_object.warning");}if(a.getValue()==""){a.setValueState(sap.ui.core.ValueState.Error);}break;case a:if(/[\-#&? ]/.test(p)){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.semantic_action.error_invalid_chars");}else if(p==""){v=sap.ui.core.ValueState.Error;}break;case b:if(p==""){v=sap.ui.core.ValueState.Error;}break;case f:if(p==""){v=sap.ui.core.ValueState.Error;}else if(!(/^[-~+,;?%&#=/.\w]+$/.test(p))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.url.error_invalid_chars");}break;case h:if(p==""){v=sap.ui.core.ValueState.Error;}else if(p.substring(0,17)=="SAPUI5.Component="){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.component.error_invalid_input");}break;case n:if(p==""){v=sap.ui.core.ValueState.Error;}else if(!(/^[\w]+$/.test(p))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.role.error_invalid_chars");}break;case N:if(p==""){v=sap.ui.core.ValueState.Error;}else if(!(/^[\w]+$/.test(p))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.instance.error_invalid_chars");}break;case i:if(p==""&&k.getValue()==""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");}else if(p!=""&&k.getValue()!=""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");k.setValueState(v);k.setValueStateText(V);}else{k.setValueState(sap.ui.core.ValueState.None);}break;case k:if(p==""&&i.getValue()==""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");}else if(p!=""&&i.getValue()!=""){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.warning");i.setValueState(v);i.setValueStateText(V);}else if(p!=""&&!(/^[A-Fa-f0-9]+$/.test(p))){v=sap.ui.core.ValueState.Error;V=T.getText("configuration.target_application.alias_id.error_invalid_chars");}else{i.setValueState(sap.ui.core.ValueState.None);}break;default:break;}if(v){o.getSource().setValueState(v);if(V!==null){o.getSource().setValueStateText(V||"");}}};sap.ushell.components.tiles.utils.checkTMInputOnSaveConfig=function(C){var T=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle(),S=C.byId("semantic_objectInput"),o=C.byId("semantic_actionInput"),a=C.byId("target_application_descriptionInput"),b=C.byId("target_application_urlInput"),f=C.byId("target_application_componentInput"),n=C.byId("navigation_provider_roleInput"),N=C.byId("navigation_provider_instanceInput"),h=C.byId("target_application_aliasInput"),i=C.byId("target_application_idInput"),k=C.byId("typeLpd_cust"),l=C.byId("typeSapui5"),m=C.byId("additionalInfo"),F=C.byId("desktopCB"),p=C.byId("tabletCB"),q=C.byId("phoneCB"),I=S.getModel().getProperty("/items"),r=false,R=false,j;if(I!=undefined){for(j=0;j<I.length;j=j+1){if(I[j].obj===S.getValue()){r=true;break;}}}if(/[\-#&? ]/.test(S.getValue())){S.setValueState(sap.ui.core.ValueState.Error);S.setValueStateText(T.getText("configuration.semantic_object.error_invalid_chars"));R=true;}else if(!r){S.setValueState(sap.ui.core.ValueState.Warning);S.setValueStateText(T.getText("configuration.semantic_object.warning"));}if(/[\-#&? ]/.test(o.getValue())){o.setValueState(sap.ui.core.ValueState.Error);o.setValueStateText(T.getText("configuration.semantic_action.error_invalid_chars"));R=true;}else if(o.getValue()==""){o.setValueState(sap.ui.core.ValueState.Error);R=true;}if(l.getSelected()){if(a.getValue()==""){a.setValueState(sap.ui.core.ValueState.Error);R=true;}if(b.getValue()==""){b.setValueState(sap.ui.core.ValueState.Error);R=true;}else if(!(/^[-~+,;?%&#=/.\w]+$/.test(b.getValue()))){b.setValueState(sap.ui.core.ValueState.Error);b.setValueStateText(T.getText("configuration.target_application.url.error_invalid_chars"));R=true;}if(f.getValue()==""){f.setValueState(sap.ui.core.ValueState.Error);R=true;}else if(f.getValue().substring(0,17)=="SAPUI5.Component="){f.setValueState(sap.ui.core.ValueState.Error);f.setValueStateText(T.getText("configuration.target_application.component.error_invalid_input"));R=true;}}else if(k.getSelected()){if(n.getValue()==""){n.setValueState(sap.ui.core.ValueState.Error);R=true;}if(!(/^[\w]+$/.test(n.getValue()))){n.setValueState(sap.ui.core.ValueState.Error);var v=T.getText("configuration.target_application.role.error_invalid_chars");n.setValueStateText(v);R=true;}if(N.getValue()==""){N.setValueState(sap.ui.core.ValueState.Error);R=true;}if(!(/^[\w]+$/.test(N.getValue()))){N.setValueState(sap.ui.core.ValueState.Error);var v=T.getText("configuration.target_application.instance.error_invalid_chars");N.setValueStateText(v);R=true;}if(h.getValue()==""&&i.getValue()==""){var v=T.getText("configuration.target_application.alias_id.warning");h.setValueState(sap.ui.core.ValueState.Error);h.setValueStateText(v);i.setValueState(sap.ui.core.ValueState.Error);i.setValueStateText(v);R=true;}if(h.getValue()!=""&&i.getValue()!=""){var v=T.getText("configuration.target_application.alias_id.warning");h.setValueState(sap.ui.core.ValueState.Error);h.setValueStateText(v);i.setValueState(sap.ui.core.ValueState.Error);i.setValueStateText(v);R=true;}if(i.getValue()!=""&&!(/^[A-Fa-f0-9]+$/.test(i.getValue()))){i.setValueState(sap.ui.core.ValueState.Error);i.setValueStateText(T.getText("configuration.target_application.alias_id.error_invalid_chars"));R=true;}}if(!F.getSelected()&&!p.getSelected()&&!q.getSelected()){var v=T.getText("configuration.form_factor.warning");F.setValueState(sap.ui.core.ValueState.Error);F.setValueStateText(v);p.setValueState(sap.ui.core.ValueState.Error);p.setValueStateText(v);q.setValueState(sap.ui.core.ValueState.Error);q.setValueStateText(v);R=true;}return R;};sap.ushell.components.tiles.utils.updateTooltipForDisabledProperties=function(C){var m=C.getModel();var i=m.getProperty("/config/isLocaleSuitable");if(!i){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();var a=r.getText("edit_configuration.original_locale_not_fit_tooltip",[m.getProperty("/config/userLocale"),m.getProperty("/config/orgLocale")]);C.byId("titleInput").setTooltip(a);C.byId("subtitleInput").setTooltip(a);C.byId("keywordsInput").setTooltip(a);C.byId("infoInput").setTooltip(a);}};sap.ushell.components.tiles.utils.createSemanticObjectModel=function(C,S,D){var v=C.getView(),u="/sap/opu/odata/UI2/INTEROP/SemanticObjects",a=[{obj:"",name:""},{obj:"*",name:"*"}],b=(D||a).slice(0),o=new sap.ui.model.json.JSONModel();o.setSizeLimit(999999);o.setProperty("/value","");o.setProperty("/enabled",true);S.bindAggregation("suggestionItems","/items",new sap.ui.core.Item({text:"{obj}"}));S.setModel(o);if(sap.ushell.components.tiles.utils.aData.length>0){o.setData({items:b.concat(sap.ushell.components.tiles.utils.aData)},true);return;}OData.read({requestUri:u,headers:{"Accept":"application/json"}},function(f,r){var I,T,i;for(i=0;i<f.results.length;i=i+1){I=f.results[i].id;T=f.results[i].text;sap.ushell.components.tiles.utils.aData.push({obj:I,name:T||I});}o.setData({items:b.concat(sap.ushell.components.tiles.utils.aData)},true);},function(E){var m=E&&E.message?E.message:E;if(E.response){m+=" - "+E.response.statusCode+" "+E.response.statusText;}jQuery.sap.log.error("Could not fetch data: "+u+": "+m,null,(v.getViewName()||"sap.ushell.components.tiles.utils"));});};sap.ushell.components.tiles.utils.displayApplicationTypeFields=function(C){if(C.byId("typeLpd_cust").getSelected()){sap.ushell.components.tiles.utils.displayLpdCustApplicationTypeFields(C);}else{sap.ushell.components.tiles.utils.displaySapui5ApplicationTypeFields(C);}};sap.ushell.components.tiles.utils.displaySapui5ApplicationTypeFields=function(C){C.getModel().setProperty('/config/navigation_provider','SAPUI5');C.byId('navigation_provider_role').setVisible(false);C.byId('navigation_provider_roleInput').setVisible(false);C.byId('navigation_provider_instance').setVisible(false);C.byId('navigation_provider_instanceInput').setVisible(false);C.byId('target_application_alias').setVisible(false);C.byId('target_application_aliasInput').setVisible(false);C.byId('target_application_id').setVisible(false);C.byId('target_application_idInput').setVisible(false);C.byId('application_description').setVisible(true);C.byId('target_application_descriptionInput').setVisible(true);C.byId('application_url').setVisible(true);C.byId('target_application_urlInput').setVisible(true);C.byId('application_component').setVisible(true);C.byId('target_application_componentInput').setVisible(true);};sap.ushell.components.tiles.utils.displayLpdCustApplicationTypeFields=function(C){C.getModel().setProperty('/config/navigation_provider','LPD');C.byId('application_description').setVisible(false);C.byId('target_application_descriptionInput').setVisible(false);C.byId('application_url').setVisible(false);C.byId('target_application_urlInput').setVisible(false);C.byId('application_component').setVisible(false);C.byId('target_application_componentInput').setVisible(false);C.byId('navigation_provider_role').setVisible(true);C.byId('navigation_provider_roleInput').setVisible(true);C.byId('navigation_provider_instance').setVisible(true);C.byId('navigation_provider_instanceInput').setVisible(true);C.byId('target_application_alias').setVisible(true);C.byId('target_application_aliasInput').setVisible(true);C.byId('target_application_id').setVisible(true);C.byId('target_application_idInput').setVisible(true);};sap.ushell.components.tiles.utils.getTileSettingsAction=function(m,a){var r=sap.ushell.components.tiles.utils.getResourceBundleModel().getResourceBundle();return{text:r.getText('tileSettingsButtonTitle'),press:function(){var b=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.ushell.ui.footerbar.SaveAsTile",viewData:{title:m.getProperty('/config/display_title_text'),subtitle:m.getProperty('/config/display_subtitle_text'),info:m.getProperty('/config/display_info_text'),icon:m.getProperty('/config/display_icon_url'),keywords:m.getProperty('/config/display_search_keywords')}});var S=new sap.ui.layout.form.SimpleForm({id:'tileSettings',layout:sap.ui.layout.form.SimpleFormLayout.GridLayout,content:[b]}).addStyleClass("sapAddBookmarkForm");var o=function(){a(b);D.close();};var f=function(A){if(A===sap.m.MessageBox.Action.OK){o();}};var h=new sap.m.Button('bookmarkOkBtn',{text:r.getText('okBtn'),press:function(){sap.m.MessageBox.confirm(r.getText('tileSettingsModifyMessage'),f);},enabled:true}),i=new sap.m.Button('bookmarkCancelBtn',{text:r.getText('cancelBtn'),press:function(){D.close();}});var j=function(k){h.setEnabled(k.trim()?true:false);};b.getTitleInput().attachLiveChange(function(){j(this.getValue());});var D=new sap.m.Dialog({id:'settingsDialog',title:r.getText('tileSettingsButtonTitle'),contentWidth:'400px',content:S,beginButton:h,endButton:i,horizontalScrolling:false,afterClose:function(){D.destroy();}});D.open();}};};}());
