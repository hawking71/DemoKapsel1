// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";jQuery.sap.declare("sap.ushell.renderers.fiori2.AccessKeysHandler");var a=function(){this.init();};a.prototype={keyCodes:jQuery.sap.KeyCodes,activateFlag:true,activateAccessibilityKeys:function(f){if(this.activateFlag===!!f){return;}this.activateFlag=!!f;if(this.activateFlag){this.init();}else{jQuery("body").off('keyup.accessKeysHandler');}},handleCatalogKey:function(){sap.ushell.renderers.fiori2.Navigation.openCatalogByHash();jQuery("#configBtn").focus();},handleHomepageKey:function(){var m=sap.ui.getCore().byId("mainShell"),s=m.getController();s.navigateToHome();jQuery("#homeBtn").focus();},handleSearchKey:function(){var s=sap.ui.getCore().byId('sf');var j=jQuery(s.getDomRef());j.click();},handleUserMenuKey:function(){var u=sap.ui.getCore().byId('userPreferencesButton');if(!u){u=new sap.ushell.ui.footerbar.UserPreferencesButton();}u.showUserPreferencesDialog();},handleAccessOverviewKey:function(){var t=sap.ushell.resources.i18n,i=sap.ui.getCore().byId("shell").getModel().getProperty("/personalization"),b=sap.ui.getCore().byId("shell").getModel().getProperty("/searchAvailable"),c=[];if(i){c.push(new sap.m.Label({text:"Alt+C"}));c.push(new sap.m.Text({text:t.getText("actionCatalog")}));}c.push(new sap.m.Label({text:"Alt+H"}));c.push(new sap.m.Text({text:t.getText("actionHomePage")}));if(b){c.push(new sap.m.Label({text:"Alt+S"}));c.push(new sap.m.Text({text:t.getText("actionSearch")}));}c.push(new sap.m.Label({text:"Alt+U"}));c.push(new sap.m.Text({text:t.getText("actionLoginDetails")}));var s=new sap.ui.layout.form.SimpleForm({editable:false,content:c}),d,o=new sap.m.Button({text:t.getText("okBtn"),press:function(){d.close();}});d=new sap.m.Dialog({id:"hotKeysGlossary",title:t.getText("hotKeysGlossary"),contentWidth:"300px",leftButton:o,afterClose:function(){d.destroy();}});d.addContent(s);d.open();},getNumberOfTileInRow:function(p){var j=jQuery(".sapUshellTile:first");if(!j.length)return false;var c=sap.ui.getCore();var t=c.byId(j.attr('id'));var b=(t.getLong()==true)?2:1;var d;if(p==="catalog"){d=jQuery("#catalogTiles .sapUshellTileContainerContent").width();}else{d=jQuery("#dashboardGroups").width();}var e=j.outerWidth(true)/b;var n=Math.floor(d/e);return n;},goToTileContainer:function(){var m=sap.ui.getCore().byId("shell").getModel(),i=m.getProperty('/tileActionModeActive');if(i){sap.ushell.renderers.fiori2.AccessKeysHandler.goToEdgeTileContainer('first');}else{return sap.ushell.renderers.fiori2.AccessKeysHandler.goToEdgeTile('first');}return true;},goToEdgeTile:function(s){var t=jQuery(".sapUshellTile:visible")[s]();if(!t.length){return false;}this.setTileFocus(t);return true;},goToEdgeTileContainer:function(s){var j=jQuery('.sapUshellTileContainer:visible')[s]();if(!j.length){return false;}this.setTileContainerSelectiveFocus(j);return true;},goToFirstTileOfSiblingGroup:function(s,e){e.preventDefault();var c=jQuery(":focus").closest(".sapUshellDashboardGroupsContainerItem");if(!c.length)return;var n=c[s+"All"](".sapUshellDashboardGroupsContainerItem:has(>div:visible):not(.sapUshellCloneArea)");var t='first';if(!n.length){n=c;t=(s==="next")?'last':'first';}else{n=n.first();}var j=n.find(".sapUshellTile:visible")[t]();this.moveScrollDashboard(j);return false;},goToFirstTileOfSiblingGroupInCatalog:function(s,e){e.preventDefault();var j=this.getFocusOnTile(jQuery(":focus"));if(!j)return;var b;if(s=="next"){var i=j.nextAll("h3").length?false:true;if(!i){b=j.nextAll("h3").first().nextAll().filter(":visible").first();}else{b=j.nextAll(".sapUshellTile").last();}}else{var c=j.prevAll("h3").length===1?true:false;if(!c){b=jQuery(j.prevAll("h3")[1]).next();}else{b=j.prevAll("h3").last().next();}}this.setTileFocus(b);this.moveScrollCatalog(b);return false;},swapTwoTilesInGroup:function(g,f,s){var b=g.getBindingContext().getObject();var c=b.tiles.indexOf(f.getBindingContext().getObject());var d=b.tiles.indexOf(s.getBindingContext().getObject());var e=b.tiles.splice(c,1,null);var h=b.tiles.splice(d,1,e[0]);b.tiles.splice(c,1,h[0]);var i=g.getBindingContext().getPath();g.getModel().setProperty(i,b);},moveTileInGroup:function(g,f,s){if(sap.ui.getCore().byId("shell").getModel().getProperty("/personalization")){var b=g.getBindingContext().getObject();var c=b.tiles.indexOf(f.getBindingContext().getObject());var d=b.tiles.indexOf(s.getBindingContext().getObject());var e=b.tiles.splice(c,1);b.tiles.splice(d,0,e[0]);var h=g.getBindingContext().getPath();g.getModel().setProperty(h,b);}},moveTileToDifferentGroup:function(s,d,c,b){if(sap.ui.getCore().byId("shell").getModel().getProperty("/personalization")){if(s.getIsGroupLocked()||d.getIsGroupLocked())return;var n;var e=s.getBindingContext().getObject();var f=d.getBindingContext().getObject();var t=e.tiles.indexOf(c.getBindingContext().getObject());if(b==="left"||b==="up"){f.tiles.push(e.tiles[t]);n=d.length;}if(b==="right"||b==="down"){f.tiles.splice(0,0,e.tiles[t]);n=0;}e.tiles.splice(t,1);var g=d.getBindingContext().getPath();d.getModel().setProperty(g,f);var h=s.getBindingContext().getPath();s.getModel().setProperty(h,e);var i=d.getTiles();return i[n];}},moveTile:function(d,s){var b=sap.ui.getCore().byId("dashboard");b.markDisableGroups();setTimeout(function(){b.unmarkDisableGroups();}.bind(this),300);var n;if(sap.ui.getCore().byId("shell").getModel().getProperty("/personalization")){if(typeof s==="undefined"){s=false;}var i=this.getGroupAndTilesInfo();if(!i||i.group.getProperty('isGroupLocked')){return;}var c=this.getNextTile(d,i);if(!c){return;}else{var e=c.getParent();}if(s){this.swapTwoTilesInGroup(i.group,i.curTile,c);}else{if(e===i.group){this.moveTileInGroup(i.group,i.curTile,c);}else{c=this.moveTileToDifferentGroup(i.group,e,i.curTile,d);}}if(sap.ushell.Layout&&sap.ushell.Layout.isInited){sap.ushell.Layout.reRenderGroupLayout(i.group);}setTimeout(function(){if(c){this.setTileFocus($(c.getDomRef()));}}.bind(this),100);}},getNextUpDownTileInCatalog:function(d,b){var n,c;var o=parseFloat(b.curTile.getDomRef().offsetLeft);if(d=="down"){n=b.tiles.slice(b.curTileIndex+1,b.curTileIndex+(b.sizeOfLine*2));}else{var s=b.curTileIndex-(b.sizeOfLine*2);s=(s>0)?s:0;n=b.tiles.slice(s,b.curTileIndex-1).reverse();}for(var i=0,l=n.length;i<l;i++){var t=n[i].getDomRef();var e=parseFloat(t.offsetLeft);var w=parseFloat(t.offsetWidth);var f=e+w;if(e<=o&&f>=o){c=n[i];break;}}return c;},getNextUpDownTileWithLayout:function(d,i,I){var n,b;var t=i.curTile.getTall()?2:1;var c=d==="down"?(t):-1;var e=!i.tiles.length;var f=i.group.getIsGroupLocked();var g=jQuery(i.curTile.getDomRef()).hasClass('sapUshellPlusTile');var l=sap.ushell.Layout.organizeGroup(i.tiles);var h=sap.ushell.Layout.getTilePositionInMatrix(i.curTile,l);var j=this.isLastLineFull(l);if(!h&&!e&&!g)return;if(!l[h.row+c]){if(I&&!f&&!g&&j&&d==="down"){return i.group.oPlusTile;}h=e||g?{row:0,col:0}:h;b=this.getNextGroup(d,i);if(!b)return;e=!b.getTiles().length;l=sap.ushell.Layout.organizeGroup(b.getTiles());c=0;h.row=d==="down"?0:l.length-1;}if(e&&f)return undefined;if(e)return b.oPlusTile;if(typeof l[h.row+c][h.col]==="object"&&!e){n=l[h.row+c][h.col];}else{n=this.getNextUpDownTile(l,h.row+c,h.col,d);}return n;},isLastLineFull:function(l){var m=this.getNumberOfTileInRow(),A=l[l.length-1].filter(Boolean);return A.length===m;},getNextUpDownTile:function(l,r,c,d){var n=r,b=l.length,e,f=d==="up"?-1:1;while((n>=0&&n<b)&&!e){if(typeof l[n][c]!=="object"){e=l[n][c];}n=n+f;}if(e)return;n=r;while((typeof l[n][c]!=="object")&&c>=0){c--;}return l[n][c];},getNextTile:function(d,b,I){var n,c,e,f,g,s,t,l,w,h,o,k=sap.ui.getCore().getConfiguration().getRTL()?-1:1,m=!b.tiles.length,p=d==="right"?1:-1,q;if(b.pageName==='catalog'){if(d=='right'||d=='left'){n=!m?b.tiles[b.curTileIndex+(k*p)]:undefined;return n;}if(b.curTileIndex==='0'&&d==='up')return undefined;c=this.whichTileRow(b.curTileIndex,b);o=parseFloat(b.curTile.getDomRef().offsetLeft);if(d=="down"){e=b.tiles.slice(b.curTileIndex+1,b.curTileIndex+(b.sizeOfLine*2));}else{s=(s>0)?s:0;e=b.tiles.slice(s,b.curTileIndex).reverse();}for(var i=0,r=e.length;i<r;i++){t=e[i].getDomRef();l=parseFloat(t.offsetLeft);w=parseFloat(t.offsetWidth);h=l+w;if(l<=o&&h>=o){n=e[i];var C=$(".sapUshellTile:visible");var N=0;for(var j=0,r=C.length;j<r;j++){if(C[j].id===e[i].sId){N=j;break;}}f=this.whichTileRow(b.curTileIndex,b);g=this.whichTileRow(N,b);if(Math.abs(f-g)>1)n=this.getNextTileInShorterRow(d,c,b);return n;}}if(this.nextRowIsShorter(d,c,b)){n=this.getNextTileInShorterRow(d,c,b);return n;}}else{q=jQuery(b.curTile.getDomRef()).hasClass('sapUshellPlusTile');if(d==="left"||d==="right"){n=!m?b.tiles[b.curTileIndex+(k*p)]:undefined;if(n){return n;}var u=this.getNextGroup(d,b);if(!u){return;}else{var v=u.getShowPlaceholder()?[].concat(u.getTiles(),u.oPlusTile):u.getTiles();if(!!v.length){var x=v.length-1;if(d==="right"){n=v[k===1?0:x];}else{n=v[k===1?x:0];}}else{n=u.oPlusTile;}}}if(d==="down"||d==="up"){if(b.pageName==="catalog"){n=this.getNextUpDownTileInCatalog(d,b);}else if(sap.ushell.Layout&&sap.ushell.Layout.isInited){n=this.getNextUpDownTileWithLayout(d,b,I);}}}return n;},getNextTileInShorterRow:function(d,c,i){var l=d==='down'?this.getLastTileIdInRow(i,c+1):this.getLastTileIdInRow(i,c-1);return i.tiles[l];},getLastTileIdInRow:function(b,l){var c=0;for(var i=0;i<b.rowsData.length;i++){c+=b.rowsData[i];if(i===l)break;}return c-1;},nextRowIsShorter:function(d,c,i){if(d==='down'&&c!=i.rowsData.length-1)return i.rowsData[c]>i.rowsData[c+1];if(d==='up'&&c!=0)return i.rowsData[c]>i.rowsData[c-1];else return false;},getNextGroup:function(d,i){var n,g=i.group.getParent().getGroups(),b=sap.ui.getCore().getConfiguration().getRTL(),c=g.indexOf(i.group);if(d==="right"||d==="left"){if(b){d=(d==="right")?"up":"down";}else{d=(d==="right")?"down":"up";}}if(d==="down"||d==="up"){var e=d==="up"?-1:1;n=g[c+e];if(!n)return;while(!n.getVisible()&&(c>=0&&c<g.length)){c=c+e;n=g[c];}}if(!n.getVisible())return;return n;},getGroupAndTilesInfo:function(j,p){if(!j){j=this.getFocusOnTile(jQuery(":focus"));}if(!j.length)return;var c=sap.ui.getCore().byId(j.attr('id'));var g=c.getParent();var r;var t;if(p=="catalog"){r=this.getCatalogLayoutData();t=new Array();var b=$('#catalogTiles').find('.sapUshellTile:visible');for(var i=0;i<b.length;i++){t.push(sap.ui.getCore().byId(b[i].id));}}else{t=g.getTiles();if(g.getShowPlaceholder()){t.push(g.oPlusTile);}}var s=this.getNumberOfTileInRow(p);return{pageName:p,curTile:c,curTileIndex:t.indexOf(c),tiles:t,sizeOfLine:s,group:g,rowsData:r}},getCatalogLayoutData:function(){var j=$('#catalogTiles .sapUshellInner').children(':visible'),m=this.getNumberOfTileInRow('catalog'),r=new Array(),c=0;for(var i=1;i<j.length;i++){if(jQuery(j[i]).hasClass("sapUshellTile")){c++;}if(jQuery(j[i]).hasClass("sapUshellHeaderTile")){r.push(c);c=0;}if(c>=m){r.push(c);c=0;}}if(c>0){r.push(c);}return r;},whichTileRow:function(b,c){var t=0,i;for(i=0;i<c.rowsData.length;i++){t+=c.rowsData[i];if(b<t)return i;}},goToSiblingElementInTileContainer:function(d,j,p){var b=j.closest('.sapUshellTileContainer'),c,e,f;if(c=this.getFocusTileContainerBeforeContent(j)){if(d==='up'){this._goToNextTileContainer(c,d);}else{f=b.find('.sapUshellTileContainerHeader:first');this.setTabIndexOnTileContainerHeader(f);f.focus();}return;}if(c=this.getFocusTileContainerHeader(j)){if(d==='up'){if(!this._goToTileContainerBeforeContent(b)){this._goToNextTileContainer(c,d);}}else{e=b.find('.sapUshellTile:first');if(e.length){this.setTileFocus(e);}else{this._goToNextTileContainer(c,d);}}return;}if(c=this.getFocusOnTile(j)){this.goFromFocusedTile(d,c,p,true);return;}if(c=this.getFocusOnTileContainerAfterContent(j)){if(d==='up'){this._goToFirstTileInTileContainer(c);}else{this._goToNextTileContainer(c,d);}}},_goToNextTileContainer:function(j,d){var b=j.closest('.sapUshellTileContainer'),A=jQuery('.sapUshellTileContainer:visible'),n=(d==='down')?1:-1,c,e;c=jQuery(A[A.index(b)+n]);if(c){e=c.find('.sapUshellTileContainerHeader');if(d==='down'){if(!this._goToTileContainerBeforeContent(c)){this.setTabIndexOnTileContainerHeader(e);this.setTileContainerSelectiveFocus(c);}}else{if(this._goToTileContainerAfterContent(c)){return;}if(!this._goToFirstTileInTileContainer(c)){this.setTabIndexOnTileContainerHeader(e);e.focus()}}}},_goToFirstTileInTileContainer:function(j){var b=j.hasClass('sapUshellTileContainer')?j:j.closest('.sapUshellTileContainer'),c=jQuery(b.find('.sapUshellTile').get(0));if(c.length){this.setTileFocus(c);return true;}else{return false;}},_goToTileContainerBeforeContent:function(j){var b=j.hasClass('sapUshellTileContainer')?j:j.closest('.sapUshellTileContainer'),c=b.find('.sapUshellTileContainerBeforeContent button:visible');if(c.length){c.focus();return true;}else{return false;}},_goToTileContainerAfterContent:function(j){var b=j.hasClass('sapUshellTileContainer')?j:j.closest('.sapUshellTileContainer'),c=b.find('.sapUshellTileContainerAfterContent button:visible');if(c.length){c.focus();return true;}else{return false;}},goFromFocusedTile:function(d,j,p,i){var b=this.getGroupAndTilesInfo(j,p),n,c,e,f,g,I;if(!b)return;n=this.getNextTile(d,b,i);if(i){c=jQuery(j).closest('.sapUshellTileContainer');if(!n){if(d==='down'){g=jQuery(c).find('.sapUshellTileContainerAfterContent button:visible');g.focus();return;}if(d==='up'){this.setTabIndexOnTileContainerHeader(c.find('.sapUshellTileContainerHeader'));this.setTileContainerSelectiveFocus(c);return;}}else{if(d==='right'||d==='left'){this.setTileFocus(jQuery(n.getDomRef()));return;}e=jQuery(n.getDomRef()).closest('.sapUshellTileContainer');I=c.length&&e.length&&(c.attr('id')===e.attr('id'));if(I){this.setTileFocus($(n.getDomRef()));}else{if(d==='down'){if(!this._goToTileContainerAfterContent(c)){this.setTabIndexOnTileContainerHeader(e.find('.sapUshellTileContainerHeader'));this.setTileContainerSelectiveFocus(e);}}else if(d==='up'){f=c.find('.sapUshellTileContainerHeader');this.setTabIndexOnTileContainerHeader(f);f.focus();}}}}else if(n){this.setTileFocus($(n.getDomRef()));}},deleteTile:function(j){var t=j.attr("id");if(!t)return;var T=sap.ui.getCore().byId(t);var b=this.getGroupAndTilesInfo(j);var n=this.getNextTile("right",b);if(!n||(n&&n.getParent()!=b.group)){n=this.getNextTile("left",b);}if(!n||(n&&n.getParent()!=b.group)){n=b.group.oPlusTile;}if(n){setTimeout((function(g,c){var d=g.getTiles();if(!d.length){if(b.group.getProperty('defaultGroup')){var f=this.getNextGroup("right",b);n=f.getTiles()[0]||f.oPlusTile;this.setTileFocus($(n.getDomRef()));}this.setTileFocus($(g.oPlusTile.getDomRef()));return;}var n;for(var i=0;i<d.length;i++){if(d[i].getProperty('uuid')==c){n=d[i];break;}}if(n){this.setTileFocus($(n.getDomRef()));}}).bind(this,b.group,n.getProperty('uuid')),100);}var e=sap.ui.getCore().getEventBus();e.publish("launchpad","deleteTile",{tileId:T.getUuid()});},setTabIndexOnTileContainerHeader:function(j){var b=j.find('.sapUshellContainerTitle:first'),c=j.find('.sapUshellContainerHeaderActions:first');j.attr('tabindex',0);b.attr('tabindex',0);c.find('button').attr('tabindex',0);},setTileContainerSelectiveFocus:function(j){var b=j.find('.sapUshellTileContainerBeforeContent button'),c=j.find('.sapUshellTileContainerHeader:first'),B=b.length&&b.is(":visible");if(B){b.focus();}else if(c.length){this.setTabIndexOnTileContainerHeader(c);c.focus();}},setTileFocus:function(j){if(!j.hasClass('sapUshellPlusTile')){var m=sap.ui.getCore().byId("shell").getModel(),c=m.getProperty("/currentState/stateName"),b;b=j.find('[tabindex]');if(c==="catalog"){this.setFocusOnCatalogTile(b.eq(0));}if(!b.length){j.attr("tabindex","0");b=j.find('[tabindex], a').andSelf().filter('[tabindex], a');}b.filter('[tabindex!="-1"]');j=b.eq(0).length?b.eq(0).closest('.sapUshellTile'):b.eq(0);}j.focus();},setFocusOnCatalogTile:function(j){var p=jQuery(".sapUshellTile[tabindex=0]"),A,v,b;if(p.length){A=p.find('[tabindex], a').andSelf().filter('[tabindex], a');A.attr("tabindex",-1);}if(!j){v=jQuery(".sapUshellTile:visible");if(v.length){b=jQuery(v[0]);j=b.find('[tabindex], a').eq(0);}else{return;}}j.closest(".sapUshellTile").attr("tabindex",0);j.attr("tabindex",0);j.closest(".sapUshellTile").find("button").attr("tabindex",0);},moveScrollDashboard:function(j){var c=j.closest(".sapUshellTileContainer")[0].id,y=-1*(document.getElementById('dashboardGroups').getBoundingClientRect().top)+document.getElementById(c).getBoundingClientRect().top;jQuery('#dashboard').animate({scrollTop:y},500,function(){this.setTileFocus(j)}.bind(this));},moveScrollCatalog:function(j){var b=jQuery("#catalogTilesPage-cont");var t=jQuery('#shell-hdr').height()+jQuery('.sapMPageHeader').height()+(parseInt(jQuery('.sapMPanelHdr').css('margin-top'),10)*2);var y=j.offset().top+b.scrollTop()-t;sap.ui.getCore().byId("catalogTilesPage").scrollTo(y,500);},goToNearbySidePanelGroup:function(d,j){var s=(d=="up")?"prev":"next";var n=j[s]();while(n.css('display')=="none"){n=n[s]();}if(!n)return;n.focus();},deleteSidePanelGroup:function(j){var c=sap.ui.getCore();var g=c.byId(j.attr('id'));var r=g.getRemovable();var e=c.getEventBus();e.publish("launchpad",r?"deleteGroup":"resetGroup",{groupId:g.getGroupId()});},moveSidePanelGroup:function(d,j){var c=sap.ui.getCore();var g=c.byId(j.attr('id'));var i=g.getIndex();var t=d=="up"?i-1:i+1;if(!i||!t)return;var b=g.getParent().getItems();if(t>=(b.length))return;var D={fromIndex:i,toIndex:t};var B=c.getEventBus();B.publish("launchpad","moveGroup",D);this.upDownButtonsHandler(d);},goToEdgeSidePanelGroup:function(s){var j=jQuery(".sapUshellGroupLI");j[s]().focus();},getFocusGroupFromSidePanel:function(j){var b=j.closest(".sapUshellGroupLI");return b.length?b:false;},getFocusGroupFromDashboard:function(j){var i=j.closest('.sapUshellTileContainerHeader').length&&j[0].tagName==='H2';return i?j:false;},getFocusTileContainerBeforeContent:function(j){var b=j.closest('.sapUshellTileContainerBeforeContent');return b.length?b:false;},getFocusTileContainerHeader:function(j){var b=j.closest('.sapUshellTileContainerHeader');return b.length?b:false;},getFocusOnTileContainerAfterContent:function(j){var b=j.closest('.sapUshellTileContainerAfterContent');return b.length?b:false;},getFocusOnTile:function(j){var b=j.closest(".sapUshellTile");return b.length?b:false;},getFocusOnCatalogPopover:function(j){var b=j.closest(".sapMPopover");return b.length?b:false;},addGroup:function(j){var c=sap.ui.getCore();var b=c.byId(j.attr('id'));b.firePress();},renameGroup:function(){var j=jQuery(":focus");var b=this.getFocusGroupFromDashboard(j);if(b){b.click();}},upDownButtonsHandler:function(d,p){var j,b=jQuery(":focus"),m=sap.ui.getCore().byId("shell").getModel(),i=m.getProperty('/tileActionModeActive');if(j=this.getFocusGroupFromSidePanel(b)){this.goToNearbySidePanelGroup(d,j);}else{if(i){this.goToSiblingElementInTileContainer(d,b,p);}else{this.goFromFocusedTile(d,j,p);}}},rightLeftButtonsHandler:function(d,p){var j=jQuery(":focus");var m=sap.ui.getCore().byId("shell").getModel();var i=m.getProperty('/tileActionModeActive');this.goFromFocusedTile(d,undefined,p,i);},homeEndButtonsHandler:function(s){var j=jQuery(":focus"),b=this.getFocusGroupFromSidePanel(j);if(j.closest("#dashboardGroups").length||j.closest("#catalogTiles").length){this.goToEdgeTile(s);return;}if(b&&b[0].id==j[0].id){this.goToEdgeSidePanelGroup(s);return;}},deleteButtonHandler:function(){if(sap.ui.getCore().byId("shell").getModel().getProperty("/personalization")){var j,b=jQuery(":focus");if(j=this.getFocusOnTile(b)){if(!j.hasClass('sapUshellLockedTile')){this.deleteTile(j);}return;}if(j=this.getFocusGroupFromSidePanel(b)){if(!j.hasClass('sapUshellEditing')&&!j.hasClass("sapUshellDefaultGroupItem")&&!j.hasClass("sapUshellTileContainerLocked")){this.deleteSidePanelGroup(j);return;}}}},ctrlUpDownButtonsHandler:function(s){var j,b=jQuery(":focus");if(j=this.getFocusOnTile(b)){this.moveTile(s,false,j);return;}if(j=this.getFocusGroupFromSidePanel(b)){this.moveSidePanelGroup(s,j);return;}this.moveTile("down");},spaceButtonHandler:function(e){var j,b=jQuery(":focus");if(j=this.getFocusGroupFromSidePanel(b)){j.click();return false;}},mainKeydownHandler:function(e){e=e||window.event;switch(e.keyCode){case this.keyCodes.SPACE:this.spaceButtonHandler(e);break;case this.keyCodes.HOME:this.homeEndButtonsHandler("first");break;case this.keyCodes.END:this.homeEndButtonsHandler("last");break;default:return true;}},catalogKeydownHandler:function(k){var h=sap.ushell.renderers.fiori2.AccessKeysHandler;var p="catalog";switch(k.keyCode){case h.keyCodes.ARROW_UP:h.upDownButtonsHandler("up",p);break;case h.keyCodes.ARROW_DOWN:h.upDownButtonsHandler("down",p);break;case h.keyCodes.ARROW_RIGHT:h.goFromFocusedTile("right","",p);break;case h.keyCodes.ARROW_LEFT:h.goFromFocusedTile("left","",p);break;case h.keyCodes.PAGE_UP:h.goToFirstTileOfSiblingGroupInCatalog('prev',k);break;case h.keyCodes.PAGE_DOWN:h.goToFirstTileOfSiblingGroupInCatalog('next',k);break;}},dashboardKeydownHandler:function(k){var h=sap.ushell.renderers.fiori2.AccessKeysHandler;switch(k.keyCode){case h.keyCodes.F2:h.renameGroup();break;case h.keyCodes.DELETE:h.deleteButtonHandler();break;case h.keyCodes.ARROW_UP:if(k.ctrlKey===true){h.ctrlUpDownButtonsHandler("up");}else{h.upDownButtonsHandler("up");}break;case h.keyCodes.ARROW_DOWN:if(k.ctrlKey===true){h.ctrlUpDownButtonsHandler("down");}else{h.upDownButtonsHandler("down");}break;case h.keyCodes.ARROW_RIGHT:if(k.ctrlKey===true){h.moveTile("right");}else{h.rightLeftButtonsHandler('right');}break;case h.keyCodes.ARROW_LEFT:if(k.ctrlKey===true){h.moveTile("left");}else{h.rightLeftButtonsHandler('left');}break;case h.keyCodes.PAGE_UP:h.goToFirstTileOfSiblingGroup('prev',k);break;case h.keyCodes.PAGE_DOWN:h.goToFirstTileOfSiblingGroup('next',k);break;}},init:function(){jQuery(document).on('keyup.accessKeysHandler',function(k){if(!this.activateFlag){return;}if(k.altKey){switch(String.fromCharCode(k.keyCode)){case'C':if(sap.ui.getCore().byId("shell").getModel().getProperty("/personalization")){this.handleCatalogKey();}break;case'H':this.handleHomepageKey();break;case'S':this.handleSearchKey();break;case'U':this.handleUserMenuKey();break;case'0':this.handleAccessOverviewKey();break;}}}.bind(this));jQuery(document).on('keydown.main',this.mainKeydownHandler.bind(this));}};sap.ushell.renderers.fiori2.AccessKeysHandler=new a();}());
