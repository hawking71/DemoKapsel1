(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchHelper');var m=sap.ushell.renderers.fiori2.search.SearchHelper={};m.Tester=function(){this.init.apply(this,arguments);};m.Tester.prototype={init:function(s){s=s||"*";s=s.replace(/([.+?^=!:${}()|\[\]\/\\])/g,"\\$1");this.aSearchTerms=this.tokenizeSearchTerms(s);for(var j=0;j<this.aSearchTerms.length;++j){this.aSearchTerms[j]=this.aSearchTerms[j].replace(/\*/g,"[^\\s]+");var i=this.aSearchTerms[j].match(/[\u3400-\u9faf]/)!==null?true:false;if(i){this.aSearchTerms[j]=new RegExp(this.aSearchTerms[j],'ig');}else{this.aSearchTerms[j]=new RegExp('(?:^|\\s)'+this.aSearchTerms[j],'ig');}}},test:function(t){var r={bMatch:false,sHighlightedText:''};if(!t){return r;}this.initializeBoldArray(t);this.globalBold=false;var R;var M=false;var a;for(var j=0;j<this.aSearchTerms.length;++j){R=this.aSearchTerms[j];M=false;while((a=R.exec(t))!==null){M=true;if(R.toString().indexOf('(?:^|\\s)[^\\s]*')===-1){this.markBoldArray(a.index,R.lastIndex);}}if(M===false){return r;}}r.bMatch=true;r.sHighlightedText=this.render(t);return r;},tokenizeSearchTerms:function(t){var a=t.split(" ");var n=[];$.each(a,function(i,b){b=$.trim(b);if(b.length>0&&b!=='.*'){n.push(b);}});return n;},initializeBoldArray:function(t){this.bold=new Array(t.length);for(var i=0;i<this.bold.length;++i){this.bold[i]=false;}},markBoldArray:function(n,a){for(var i=n;i<a;i++){this.bold[i]=true;this.globalBold=true;}},render:function(o){if(!this.globalBold){return o;}var b=false;var r=[];var s=0;var i;for(i=0;i<o.length;++i){if((!b&&this.bold[i])||(b&&!this.bold[i])){r.push(o.substring(s,i));if(b){r.push("</b>");}else{r.push("<b>");}b=!b;s=i;}}r.push(o.substring(s,i));if(b){r.push("</b>");}return r.join("");}};m.delayedExecution=function(o,d){var t=null;var a=function(){var b=arguments;var s=this;if(t){window.clearTimeout(t);}t=window.setTimeout(function(){t=null;o.apply(s,b);},d);};a.abort=function(){if(t){window.clearTimeout(t);}};return a;};m.refuseOutdatedRequests=function(o,r){var a=0;var d=function(){var b=arguments;var s=this;var c=++a;var e=jQuery.Deferred();o.apply(s,b).done(function(){if(c!==a){return;}e.resolve.apply(e,arguments);}).fail(function(){if(c!==a){return;}e.reject.apply(e,arguments);});return e;};d.abort=function(){++a;};if(r){m.outdatedRequestAdministration.registerDecorator(r,d);}return d;};m.abortRequests=function(r){var d=m.outdatedRequestAdministration.getDecorators(r);for(var i=0;i<d.length;++i){var a=d[i];a.abort();}};m.outdatedRequestAdministration={decoratorMap:{},registerDecorator:function(r,d){var a=this.decoratorMap[r];if(!a){a=[];this.decoratorMap[r]=a;}a.push(d);},getDecorators:function(r){var d=this.decoratorMap[r];if(!d){d=[];}return d;}};m.boldTagUnescaper=function(d){var i=d.innerHTML;while(i.indexOf('&lt;b&gt;')+i.indexOf('&lt;/b&gt;')>=-1){i=i.replace('&lt;b&gt;','<b>');i=i.replace('&lt;/b&gt;','</b>');}while(i.indexOf('&lt;i&gt;')+i.indexOf('&lt;/i&gt;')>=-1){i=i.replace('&lt;i&gt;','<i>');i=i.replace('&lt;/i&gt;','</i>');}d.innerHTML=i;};m.boldTagUnescaperByText=function(d){var a=$(d);var s=a.text().replace(/<b>/gi,'').replace(/<\/b>/gi,'');if(s.indexOf('<')===-1){a.html(a.text());}};m.forwardEllipsis4Whyfound=function(d){var a=$(d);var p=a.html().indexOf("<b>");if(p>-1&&d.offsetWidth<d.scrollWidth){var e="..."+a.html().substring(p);a.html(e);}};m.hasher={hash:null,setHash:function(h){if(window.location.hash!==h){window.location.hash=h;this.hash=h;}},hasChanged:function(){if(this.hash!==window.location.hash){return true;}return false;}};m.loadFilterButtonStatus=function(){if(jQuery.sap.storage.isSupported()){var f=jQuery.sap.storage.get("showSearchFacets");if(!f){return false;}else{return true;}}else{return false;}};m.saveFilterButtonStatus=function(a){if(jQuery.sap.storage.isSupported()){jQuery.sap.storage.put("showSearchFacets",a);}};})();
