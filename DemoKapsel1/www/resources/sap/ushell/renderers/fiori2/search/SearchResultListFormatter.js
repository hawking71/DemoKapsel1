(function(){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchResultListFormatter');jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchHelper');var S=sap.ushell.renderers.fiori2.search.SearchHelper;var m=sap.ushell.renderers.fiori2.search.SearchResultListFormatter=function(){this.init.apply(this,arguments);};m.prototype={init:function(){},format:function(s,t){return this._doFormat(s.getElements(),t);},_getImageUrl:function(r){var i={imageUrl:'',name:''};for(var p in r){var a=r[p];var b=false;try{if(a.value&&a.$$MetaData$$.presentationUsage.indexOf('Thumbnail')>=0){b=true;}}catch(e){}if(!b){continue;}i.imageUrl=a.value;i.name=p;return i;}return i;},_moveWhyFound2ResponseAttr:function(w,p){var l=w.length;while(l--){if(w[l].labelRaw===p.labelRaw&&p!==undefined){p.value=w[l].value;p.whyfound=true;w.splice(l,1);}}},_appendRemainingWhyfounds2FormattedResultItem:function(w,i){var l=w.length;while(l--){if(w[l].labelRaw!==undefined){var I={};I.name=w[l].label;I.value=w[l].value;I.whyfound=true;i.push(I);w.splice(l,1);}}},_doFormat:function(r,t){var s=function(a,b){return a.displayOrder-b.displayOrder;};var T=new S.Tester(t);var o;var f=[];for(var i=0;i<r.length;i++){var c=r[i];var u='';var d=c.$$RelatedActions$$;for(var e in d){if(d[e].type==="Navigation"){u=d[e].uri;}}var w=c.$$WhyFound$$||[];var g=[];var h=[];var j='';for(var p in c){if(!c[p].label||!c[p].$$MetaData$$){continue;}var k=c[p].$$MetaData$$.presentationUsage||[];if(k&&k.length>0){if(k.indexOf("Title")>-1&&c[p].value){this._moveWhyFound2ResponseAttr(w,c[p]);j=j+" "+c[p].value;}if(k.indexOf("Summary")>-1){g.push({property:p,displayOrder:c[p].$$MetaData$$.displayOrder});}else if(k.indexOf("Detail")>-1){h.push({property:p,displayOrder:c[p].$$MetaData$$.displayOrder});}}}g.sort(s);h.sort(s);var l=g.concat(h);var n={};var q=this._getImageUrl(c);n.imageUrl=q.imageUrl;o=T.test(c.$$DataSourceMetaData$$.label);n.dataSourceName=o.bMatch===true?o.sHighlightedText:c.$$DataSourceMetaData$$.label;n.uri=u;n.$$Name$$='';var I=[];for(var z=0;z<l.length;z++){var v=l[z].property;var x={};if(v!==q.name){this._moveWhyFound2ResponseAttr(w,c[v]);x.name=c[v].label;x.value=c[v].value;if(c[v].whyfound){x.whyfound=c[v].whyfound;}I.push(x);}}n.$$Name$$=j.trim();n.numberofattributes=l.length;n.title=c.title;n.itemattributes=I;this._appendRemainingWhyfounds2FormattedResultItem(w,n.itemattributes);f.push(n);}return f;}};})();
