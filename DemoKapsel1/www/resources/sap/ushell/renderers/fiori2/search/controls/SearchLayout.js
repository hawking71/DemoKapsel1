(function(){"use strict";jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchHelper');var s=sap.ushell.renderers.fiori2.search.SearchHelper;sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.SearchLayout",{metadata:{properties:{count:"int",searchTerm:"string",searchBusy:{type:"boolean",defaultValue:false},showFacets:{type:"boolean",defaultValue:false}},aggregations:{"SearchFieldGroup":{type:"sap.ui.core.Control",multiple:false},"topList":{type:"sap.ui.core.Control",multiple:false},"bottomList":{type:"sap.ui.core.Control",multiple:false},"tabStrips":{type:"sap.ui.core.Control",multiple:false},"facets":{type:"sap.ui.core.Control",multiple:false},"_countLabel":{type:"sap.m.Label",multiple:false,visibility:"hidden"},}},constructor:function(o,i){var a=this;sap.ui.core.Control.prototype.constructor.apply(this,[o],i);var c=new sap.m.Label();c.addStyleClass('searchLayout-mainHeaderCount');a.setAggregation("_countLabel",c);a.setProperty('showFacets',s.loadFilterButtonStatus(),true);},initVisibility:function(){var a=this.getShowFacets();if(this.getTabStrips()){if(a||jQuery.device.is.phone){this.getTabStrips().setVisible(false);}else{this.getTabStrips().setVisible(true);}}if(!a&&this.oFilterBar.hasContent()===true){this.oFilterBar.setVisible(true);this.oAppPage.setShowSubHeader(true);}else{this.oFilterBar.setVisible(false);this.oAppPage.setShowSubHeader(false);}},setCount:function(c){this.setProperty('count',c,true);this.getAggregation('_countLabel').setText('('+c+')');},setSearchTerm:function(a){this.setProperty('searchTerm',a,true);},renderSearchFieldGroup:function(r,c){r.write("<div");r.addClass("searchInputs");r.writeClasses();r.write('>');if(this.getSearchFieldGroup()){r.renderControl(this.getSearchFieldGroup());}r.write("</div>");},renderBusyIndicator:function(r,c){this.busy=new sap.m.BusyIndicator({size:"50px"});this.busy.addStyleClass('searchBusyIcon');this.busy.addStyleClass('hidden');if(c.getSearchBusy()===true){this.busy.removeStyleClass('hidden');r.write("<div");r.addClass("searchBusy");r.writeClasses();r.write('>');r.renderControl(this.busy);r.write("</div>");r.write("<div");r.addClass("searchBusyBG");r.writeClasses();r.write('>');r.write("</div>");}},renderMainHeader:function(r,c){if(!c.isNoResultsShown()&&c.getSearchBusy()===false){r.write('<div class="searchLayout-mainHeader">');r.renderControl((new sap.m.Label({text:sap.ushell.resources.i18n.getText("searchResults")})).addStyleClass('searchLayout-mainHeaderName'));r.renderControl(c.getAggregation('_countLabel'));r.write('</div>');}},isNoResultsShown:function(){return this.getCount()===0;},renderNoResults:function(r,c){if(c.isNoResultsShown()&&c.getSearchBusy()===false){var e=$('<div>').text(c.getSearchTerm()).html();r.write('<div class="no-result"><div class="no-result-icon">');r.writeIcon(sap.ui.core.IconPool.getIconURI("travel-request"));r.write('</div><div class="no-result-text">');r.write('<div class="no-result-info">'+sap.ushell.resources.i18n.getText("no_results_info").replace('&1',e)+'</div>');r.write('<div class="no-result-tips">'+sap.ushell.resources.i18n.getText("no_results_tips")+'</div> ');r.write('</div></div>');}},renderTopList:function(r,c){if(c.getTopList()){r.renderControl(c.getTopList());}},renderBottomList:function(r,c){if(c.getBottomList()){r.renderControl(c.getBottomList());}},setFilterBar:function(f){this.oFilterBar=f;},setAppPage:function(a){this.oAppPage=a;},setShowFacets:function(a,i){if(this.getTabStrips()){if(a||jQuery.device.is.phone){this.getTabStrips().setVisible(false);}else{this.getTabStrips().setVisible(true);}}if(this.getModel()){this.getModel().setFacetVisibility(a);}var b=jQuery(".searchFacets");if(i===undefined){i=true;}var w;var o;var p;var c;if(!a){w="0";o="0";p="2rem";if(this.oFilterBar.hasContent()===true){this.oFilterBar.setVisible(true);this.oAppPage.setShowSubHeader(true);}else{this.oFilterBar.setVisible(false);this.oAppPage.setShowSubHeader(false);}}else{w="18rem";o="1";p="1rem";this.oFilterBar.setVisible(false);this.oAppPage.setShowSubHeader(false);}b.animate({width:w,opacity:o},{complete:function(){sap.ui.getCore().getEventBus().publish("searchLayoutChanged");},duration:i?400:0});var P={};var d;if(jQuery("html").attr("dir")==='rtl'){d="padding-right";}else{d="padding-left";}P[d]=p;if(sap.ui.Device.system.desktop){jQuery(".searchResultListsContainer").animate(P,{duration:i?400:0});}this.setProperty("showFacets",a,true);s.saveFilterButtonStatus(a);return this;},renderTabStrips:function(r,c){if(c.isNoResultsShown()){return;}if(!c.getTabStrips()){return;}r.renderControl(c.getTabStrips());},renderer:function(r,c){r.write("<div");r.writeControlData(c);r.addClass("searchLayout");r.writeClasses();r.write('>');if(c.getFacets()){r.write('<div');r.addClass('searchFacets');r.writeClasses();if(!c.getShowFacets()){r.write('style="width:0;opacity:0"');}r.write('>');r.renderControl(c.getFacets());r.write('</div>');}r.write("<div");r.addClass("searchResultListsContainer");r.writeClasses();if(sap.ui.Device.system.desktop){if(c.getFacets()&&c.getShowFacets()===true){r.write('style="padding-left:1rem;"');}else{r.write('style="padding-left:2rem;"');}}r.write('>');c.renderBusyIndicator(r,c);c.renderSearchFieldGroup(r,c);c.renderMainHeader(r,c);c.renderTabStrips(r,c);c.renderNoResults(r,c);c.renderTopList(r,c);c.renderBottomList(r,c);r.write("</div>");r.write("</div>");}});})();
