(function(){"use strict";jQuery.sap.require('sap.ushell.renderers.fiori2.search.controls.SearchResultListItemButton');jQuery.sap.require('sap.ushell.renderers.fiori2.search.SemanticObjectsHandler');jQuery.sap.require('sap.ushell.renderers.fiori2.search.controls.SearchText');jQuery.sap.require('sap.ushell.renderers.fiori2.search.controls.SearchLink');jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchHelper');var S=sap.ushell.renderers.fiori2.search.controls.SearchResultListItemButton;var a=sap.ushell.renderers.fiori2.search.SemanticObjectsHandler;var b=sap.ushell.renderers.fiori2.search.controls.SearchText;var c=sap.ushell.renderers.fiori2.search.controls.SearchLink;var s=sap.ushell.renderers.fiori2.search.SearchHelper;sap.m.ListItemBase.extend("sap.ushell.renderers.fiori2.search.controls.SearchResultListItem",{metadata:{properties:{title:"string",titleUrl:"string",type:"string",imageUrl:"string",previewButton:"string",data:"object",visibleAttributes:"int",firstDetailAttribute:{type:"int",defaultValue:4},maxDetailAttributes:{type:"int",defaultValue:8}},events:{navigate:{}}},renderer:function(r,C){var d=C;d.resetPrecalculatedValues();d.showExpandButton=false;d.renderOuterContainer(r);},renderOuterContainer:function(r){var d=this;r.write("<div");r.writeControlData(d);if(d.status==="open"||d.getData().selected===true){r.addClass("searchResultListItem-open");}r.writeClasses();r.write(">");d.renderIntermediateContainer(r);var e=(d.showExpandButton&&d.getPreviewButton()!=="false");d.renderExpandButton(r,e);r.write("</div>");},renderIntermediateContainer:function(r){var d=this;r.write('<div class="searchResultListItem-main"><div>');d.renderInnerContainer(r);d.renderRelatedObjectsForPhone(r);r.write("</div></div>");},renderInnerContainer:function(r){var d=this;r.write('<div class="searchResultListItem-left">');r.write('<div class="searchResultListItem-titleContainer">');d.renderImageForPhone(r);d.renderTitle(r);d.renderRelatedObjects(r);r.write('</div>');var p=0;var i=d.getData().itemattributes;d.renderAttributes(r,i,p);r.write("</div>");},renderTitle:function(r){var d=this;if(!d.titleUrl){d.titleUrl=d.getTitleUrl();}var t=encodeURI(d.titleUrl);d.title=new c({text:d.getTitle(),href:t});d.title.setTooltip((sap.ushell.resources.i18n.getText('linkTo_tooltip')+' '+d.getTitle()).replace(/<b>/gi,'').replace(/<\/b>/gi,''));d.title.addStyleClass("searchResultListItem-title");r.renderControl(d.title);var e=new b({text:d.getType()});e.setTooltip((''+d.getType()).replace(/<b>/gi,'').replace(/<\/b>/gi,''));e.addStyleClass("searchResultListItem-type");r.renderControl(e);},renderImage:function(r){var d=this;if(d.getImageUrl()){r.write('<div class="searchResultListItem-attribute searchResultListItem-imageDesktop-outerContainer">');r.write('<div class="searchResultListItem-imageDesktop-innerContainer">');r.write('<div class="searchResultListItem-imageDesktop-alignmentHelper">');r.write('</div>');r.write('<img class="searchResultListItem-imageDesktop" src="');r.write(d.getImageUrl());r.write('">');r.write('</div>');r.write('</div>');}},renderImageForPhone:function(r){var d=this;if(d.getImageUrl()){r.write('<div class="searchResultListItem-imagePhone" style="background-image:url(\'');r.write(d.getImageUrl());r.write('\')"></div>');}},renderRelatedObjects:function(r){var d=this;var t="";var e="";var l="";r.write('<div class="searchResultListItem-relatedObjectsContainer-desktop">');r.write('<div class="searchResultListItem-relatedObjectsContainer"');if(!d.relatedObjects){r.write('style="display:none"');}else{t=d.relatedObjects.text;e=d.relatedObjects.text;l="#"+d.relatedObjects.link;}r.write('>');var f=new sap.m.Text({text:"|"});f.addStyleClass("searchResultListItem-type");f.addStyleClass("searchResultListItem-relatedObjectsSeparator");r.renderControl(f);d.relatedObjectsLink=new c({text:t,href:l});d.relatedObjectsLink.setTooltip(e);d.relatedObjectsLink.addStyleClass("searchResultListItem-type");d.relatedObjectsLink.addStyleClass("searchResultListItem-relatedObjects");r.renderControl(d.relatedObjectsLink);r.write('</div>');r.write('</div>');},renderRelatedObjectsForPhone:function(r){var d=this;var t="";var e="";var l="";r.write('<div class="searchResultListItem-relatedObjectsContainer-phone">');r.write('<div class="searchResultListItem-relatedObjectsContainer"');if(!d.relatedObjects){r.write('style="display:none"');}else{t=d.relatedObjects.text;e=d.relatedObjects.text;l="#"+d.relatedObjects.link;}r.write('>');d.relatedObjectsLink2=new c({text:t,href:l});d.relatedObjectsLink2.setTooltip(e);r.renderControl(d.relatedObjectsLink2);r.write('</div>');r.write('</div>');},renderAttributes:function(r,i,p){var d=this;r.write('<div class="searchResultListItem-attributes">');r.write('<div class="searchResultListItem-visibleAttributes">');p=d.renderSummaryAttributes(r,i,p);d.renderImage(r);r.write("</div>");p=d.renderDetailAttributes(r,i,p);r.write("</div>");return p;},renderSummaryAttributes:function(r,i,p){var d=this;var v=d.getNumberOfVisibleAttributes();for(;p<i.length&&p<v;p++){var e=i[p];var l=e.name;var f=e.value;if(l===undefined||f===undefined){continue;}if(!f||f===""){f="&nbsp;";}r.write('<div class="searchResultListItem-attribute">');var g=new sap.m.Label({text:l});g.setTooltip((''+l).replace(/<b>/gi,'').replace(/<\/b>/gi,''));g.addStyleClass("searchResultListItem-attribute-label");r.renderControl(g);var h=new b({text:f});h.setTooltip((''+f).replace(/<b>/gi,'').replace(/<\/b>/gi,''));h.addStyleClass("searchResultListItem-attribute-value");r.renderControl(h);r.write("</div>");}return p;},renderDetailAttributes:function(r,d,p){var e=this;if(e.isPhoneSize()){return p;}var l,v;var f=e.getMaxDetailAttributes();if(f>8){f=8;}var g=[];var h=p+f;for(;p<h&&p<d.length;p++){var j=d[p];l=j.name;v=j.value;if(l===undefined||v===undefined){continue;}if(!v||v===""){v="&nbsp;";}var k={labelText:l,valueText:v};g.push(k);}if(g.length>0){e.showExpandButton=true;}r.write('<div class="searchResultListItemDetails2"');if(e.status!=="open"){r.write(' style="display:none"');}r.write('>');r.write('<div class="searchResultListItem-detailsAttributes">');for(var i=0;i<g.length;i++){var m=g[i];l=m.labelText;v=m.valueText;if(l===undefined||v===undefined){continue;}if(!v||v===""){v="&nbsp;";}r.write('<div class="searchResultListItem-attribute">');var n=new sap.m.Label({text:l});n.setTooltip((''+l).replace(/<b>/gi,'').replace(/<\/b>/gi,''));n.addStyleClass("searchResultListItem-attribute-label");r.renderControl(n);var o=new b({text:v});o.setTooltip((''+v).replace(/<b>/gi,'').replace(/<\/b>/gi,''));o.addStyleClass("searchResultListItem-attribute-value");r.renderControl(o);r.write("</div>");}r.write('</div>');p=e.renderWhyFoundAttributes(r,d,p);r.write('</div>');return p;},renderWhyFoundAttributes:function(r,d,p){var e=this;var l,v;var w=[];var f;for(;p<d.length;p++){var g=d[p];if(!g.whyfound){continue;}l=g.name;v=g.value;if(l===undefined||v===undefined){continue;}if(!v||v===""){v="&nbsp;";}f={labelText:l,valueText:v};w.push(f);}if(w.length>0){e.showExpandButton=true;r.write('<div class="searchResultListItem-whyFoundContainer">');for(var i=0;i<w.length;i++){f=w[i];l=f.labelText;v=f.valueText;if(l===undefined||v===undefined){continue;}if(!v||v===""){v="&nbsp;";}r.write('<div class="searchResultListItem-attribute">');var h=new sap.m.Label({text:l});h.setTooltip((''+l).replace(/<b>/gi,'').replace(/<\/b>/gi,''));h.addStyleClass("searchResultListItem-attribute-label");r.renderControl(h);var j=new b({text:v});j.setTooltip((''+v).replace(/<b>/gi,'').replace(/<\/b>/gi,''));j.addStyleClass("searchResultListItem-attribute-value");r.renderControl(j);r.write("</div>");}r.write("</div>");}return p;},renderRelatedObjectsToolbar:function(r){var d=this;var m=5;var e=["Corporealness","Crownbeard","Admired","Fulvid","Granatite","Slighting","Presbyterial","Deceit","Sarcasmous","Huloist","Photo etching","Resemblingly","Corporealness"];var f=[];for(var x=0;x<e.length;x++){f.push(new sap.m.Link({text:e[x],}));}if(f.length>0){var t=[new sap.m.ToolbarSpacer(),new sap.m.ToolbarSpacer({width:"1rem"})];var k;for(k=0;k<m&&k<f.length;k++){t.push(f[k]);t.push(new sap.m.ToolbarSpacer({width:"1rem"}));if(k>=3){f[k].addStyleClass("sapUIDesktopOnly");}}if(k<f.length){var o=[];for(;k<f.length;k++){o.push(new sap.m.Button({text:f[k].getText()}));}var g=new sap.m.Button({icon:sap.ui.core.IconPool.getIconURI("overflow")});var h=new sap.m.ActionSheet({placement:sap.m.PlacementType.Top,buttons:o});g.attachPress(function(){h.openBy(g);});t.push(g);}d.relatedObjectActionsToolbar=new sap.m.Toolbar({design:sap.m.ToolbarDesign.Solid,content:t,});d.relatedObjectActionsToolbar.addStyleClass("searchResultListItem-relatedObjectsToolbar");r.renderControl(d.relatedObjectActionsToolbar);}},renderExpandButton:function(r,d){var e=this;r.write('<div class="searchResultListItemButton">');r.write('<div class="searchResultListItemButtonContainer');if(!d){r.write(' searchResultListItemButtonContainer-hidden');}r.write('">');var i=sap.ui.core.IconPool.getIconURI("slim-arrow-up");var f=sap.ui.core.IconPool.getIconURI("slim-arrow-down");e.button=new sap.m.Button({icon:f,type:sap.m.ButtonType.Transparent,tooltip:sap.ushell.resources.i18n.getText("showDetailBtn_tooltip"),press:function(){var g=$(e.getDomRef()).find('.searchResultListItemDetails2');if(g&&g.length===1){var h=g.css('display')!=="none";if(h){g.slideUp("fast",function(){e.button.setTooltip(sap.ushell.resources.i18n.getText("showDetailBtn_tooltip"));e.button.setIcon(f);e.button.rerender();});}else{g.slideDown("fast",function(){e.button.setTooltip(sap.ushell.resources.i18n.getText("hideDetailBtn_tooltip"));e.button.setIcon(i);e.button.rerender();e.forwardEllipsis(g.find(".searchResultListItem-attribute-value"));});}}}});r.renderControl(e.button);r.write('</div>');r.write('</div>');},onAfterRendering:function(){var d=this;var t;if(!d.loadingRelatedObjects){d.loadingRelatedObjects=true;t=d.titleUrl;if(t&&t.length>0){t=encodeURI(t);try{if(t.charAt(0)==='#'){t=t.substring(1);}var f=a.linkDetermination(t).done(function(l){if(!l){return;}if(!l.mainLink){d.title.setHref("#");return;}else{var n="#"+l.mainLink;d.titleUrl=n;d.title.setHref(n);}var r=l.relatedLink;if(r){d.relatedObjects=r;var i=$(d.getDomRef()).find('.searchResultListItem-relatedObjectsContainer');if(i){var j=encodeURI(r.link);d.relatedObjectsLink.setTooltip(r.text);d.relatedObjectsLink.setText(r.text);d.relatedObjectsLink.setHref("#"+j);d.relatedObjectsLink2.setTooltip(r.text);d.relatedObjectsLink2.setText(r.text);d.relatedObjectsLink2.setHref("#"+j);i.css("display","inline-block");}else{d.rerender();}}});}catch(e){}}}var p=767;var g=1150;var w=$(window).width();if(w<=p){t=d.titleUrl;if(t&&t.length>0){t=encodeURI(t);$(d.getDomRef()).find(".searchResultListItem-left").bind('click',d.fireNavigate(t));}}var h=$('.searchResultListItem-attribute-value');h.each(function(){if($(this).prev().hasClass('searchResultListItem-attribute-label')){$(this).attr('aria-label',$(this).prev().text());}});},isDesktopSize:function(){var w=$(window).width();if(!(this.isTabletSize()||this.isPhoneSize())){return true;}return false;},isTabletSize:function(){var w=$(window).width();if(w<=1150&&!this.isPhoneSize()){return true;}return false;},isPhoneSize:function(){var w=$(window).width();if(w<=767){return true;}return false;},getNumberOfVisibleAttributes:function(){var d=this;if(!d._visibleAttributes){var v=d.getVisibleAttributes();if(!d.isDesktopSize()){v=3;}if(!d.isPhoneSize()&&d.getImageUrl()){v--;}d._visibleAttributes=v;}return d._visibleAttributes;},resetPrecalculatedValues:function(){this._visibleAttributes=undefined;},fireNavigate:function(u){return function(){if(u){window.location.href=u;}};},forwardEllipsis:function(o){o.each(function(i,d){s.forwardEllipsis4Whyfound(d);});}});})();
