// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";jQuery.sap.declare("sap.ushell.services.AppConfiguration");function A(){var m={},c=null;this.getCurrentAppliction=function(a){return c;};this.getMetadata=function(a){if(!a){a=c;}if(a){var k=this.getApplicationUrl(a);if(!(m.hasOwnProperty(k))){this.addMetadata(a);}return m[k]||{};}return{};};this.setCurrentApplication=function(a){c=a;};this.addApplicationSettingsButtons=function(b){var M=sap.ui.getCore().byId('shell')&&sap.ui.getCore().byId('shell').getModel(),i,j,C,B,a;if(!M){jQuery.sap.log.error("shell does not exist");return;}a=M.getProperty('/currentState/shellActions');B=M.getProperty('/currentState/actions');B.length=0;for(i=0;i<b.length;i=i+1){C=b[i];C.setIcon(C.getIcon()||sap.ui.core.IconPool.getIconURI('action-settings'));B.push(C.getId());}for(j=0;j<a.length;j=j+1){B.push(a[j]);}M.setProperty('/currentState/actions',B);};this.setWindowTitle=function(t){window.document.title=t;};this.setIcons=function(i){jQuery.sap.setIcons(i);};this.getSettingsControl=function(){jQuery.sap.require("sap.ushell.ui.footerbar.SettingsButton");return new sap.ushell.ui.footerbar.SettingsButton();};this.getApplicationName=function(a){var M,s=(a&&a.additionalInformation)||null;if(s){M=/^SAPUI5\.Component=(.+)$/i.exec(s);if(M){return M[1];}}return null;};this.getApplicationUrl=function(a){var u=(a&&a.url)||null,i;if(u){i=u.indexOf("?");if(i>=0){u=u.slice(0,i);}if(u.slice(-1)!=='/'){u+='/';}}return u;};this.addMetadata=function(a){try{var C=this.getApplicationName(a),u=this.getApplicationUrl(a),s,o,r,R,l,b,i,p,v,P=["fullWidth","title","icon","favIcon","homeScreenIconPhone","homeScreenIconPhone@2","homeScreenIconTablet","homeScreenIconTablet@2","startupImage320x460","startupImage640x920","startupImage640x1096","startupImage768x1004","startupImage748x1024","startupImage1536x2008","startupImage1496x2048"],d,e,f;if(u&&!(m.hasOwnProperty(u))){m[u]={};o=sap.ui.component.load({url:u,name:C});l=o.getMetadata();if(l){b=l&&l.getConfig();if(b){R=b.resourceBundle||"";if(R){if(R.slice(0,1)!=='/'){R=u+R;}r=jQuery.sap.resources({url:R,locale:sap.ui.getCore().getConfiguration().getLanguage()});}}for(i=0;i<P.length;i=i+1){v=undefined;p=P[i];if(r&&b.hasOwnProperty(p+"Resource")){v=r.getText(b[p+"Resource"]);}else if(b.hasOwnProperty(p)){v=b[p];}m[u][p]=v;}}m[u].version=l.getVersion();m[u].libraryName=l.getLibraryName();d=["favIcon","homeScreenIconPhone","homeScreenIconPhone@2","homeScreenIconTablet","homeScreenIconTablet@2","startupImage320x460","startupImage640x920","startupImage640x1096","startupImage768x1004","startupImage748x1024","startupImage1536x2008","startupImage1496x2048"];e=(u&&u[u.length-1]==='/')?u.substring(0,u.length-1):u;f=function(u){if(u.match(/^https?:\/\/.*/)){return false;}return u&&u[0]!=='/';};d.forEach(function(h){var O=m[u][h],F=null;if(O){F=f(O)?e+"/"+O:O;}m[u][h]=F;});}}catch(g){jQuery.sap.log.warning("Application configuration could not be parsed");}};}sap.ushell.services.AppConfiguration=new A();}());
