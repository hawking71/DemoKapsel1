// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";jQuery.sap.declare("sap.ushell.services.CrossApplicationNavigation");jQuery.sap.require("sap.ushell.services.Personalization");sap.ushell.services.CrossApplicationNavigation=function(){var a;function b(t){var r=sap.ushell.Container.getService("NavTargetResolution").getCurrentResolution(),s,S;if(r&&r.url){S=jQuery.sap.getUriParameters(r.url).get("sap-system");}if(!S||typeof t!=="object"){return;}if(t.target&&t.target.shellHash){if(typeof t.target.shellHash==="string"&&!/[?&]sap-system=/.test(t.target.shellHash)){s=(t.target.shellHash.indexOf("?")>-1)?"&":"?";t.target.shellHash+=s+"sap-system="+S;}return;}t.params=t.params||{};if(!Object.prototype.hasOwnProperty.call(t.params,"sap-system")){t.params["sap-system"]=S;}}this.hrefForExternal=function(A,c,d){if(sap.ushell&&sap.ushell.services&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){b(A);return sap.ushell.Container.getService("ShellNavigation").hrefForExternal(A,undefined,c,d);}jQuery.sap.log.debug("Shell not available, no Cross App Navigation");if(d){return(new jQuery.Deferred()).resolve("").promise();}return"";};this.expandCompactHash=function(h){return sap.ushell.Container.getService("NavTargetResolution").expandCompactHash(h);};this.backToPreviousApp=function(){this.historyBack();};this.historyBack=function(){window.history.back();};this.toExternal=function(A,c){if(sap.ushell&&sap.ushell.services&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){b(A);sap.ushell.Container.getService("ShellNavigation").toExternal(A,c);return;}jQuery.sap.log.debug("Shell not avialable, no Cross App Navigation");return;};this.hrefForAppSpecificHash=function(A){if(sap.ushell&&sap.ushell.services&&sap.ushell.Container&&typeof sap.ushell.Container.getService==="function"&&sap.ushell.Container.getService("ShellNavigation")){return sap.ushell.Container.getService("ShellNavigation").hrefForAppSpecificHash(A);}jQuery.sap.log.debug("Shell not available, no Cross App Navigation; fallback to app-specific part only");return"#"+encodeURI(A);};this.getSemanticObjectLinks=function(s,p,i,c,A){return sap.ushell.Container.getService("NavTargetResolution").getSemanticObjectLinks(s,p,i,c,A);};this.isIntentSupported=function(i){return sap.ushell.Container.getService("NavTargetResolution").isIntentSupported(i);};this.createEmptyAppState=function(A){if(!a){a=sap.ushell.Container.getService("AppState");}if(!(A instanceof sap.ui.core.UIComponent)){throw new Error("oAppComponent passed must be a UI5 Component");}return a.createEmptyAppState(A);};this.getStartupAppState=function(A){this._checkComponent(A);var c=A.getComponentData()&&A.getComponentData()["sap-xapp-state"]&&A.getComponentData()["sap-xapp-state"][0];return this.getAppState(A,c);};this._checkComponent=function(A){if(!(A instanceof sap.ui.core.UIComponent)){throw new Error("oComponent passed must be a UI5 Component");}};this.getAppState=function(A,s){var c,d=new jQuery.Deferred();this._checkComponent(A);if(!a){a=sap.ushell.Container.getService("AppState");}if(typeof s!=="string"){if(s!==undefined){jQuery.sap.log.error("Illegal Argument sAppStateKey ");}setTimeout(function(){c=a.createEmptyUnmodifiableAppState(A);d.resolve(c);},0);return d.promise();}return a.getAppState(s);};};sap.ushell.services.CrossApplicationNavigation.hasNoAdapter=true;}());
